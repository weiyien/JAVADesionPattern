享元模式
---
以共享的方式高效的支持大量细粒度对象的重用
享元对象区分了内部状态和外部状态
内部状态可以共享,不会随环境变化而改变
外部状态不可以共享,会随环境变化而改变
在内存小情况下如果有多个完全相同或相似的对象,通过享元模式节省内存.
享元模式四元素:
- FlyWeightFactory享元工厂类.创建并管理享元对象,享元池一般为键值对.
- FlyWeight抽象享元类.通常为接口或抽象类,声明公共方法,向外界提供对象内部状态,设置外部状态
- ConcreteFlyWeight具体享元类.为内部状态提供成员变量进行存储
- UnSharedConcreteFlyWeight非共享享元类.不能被共享的子类可以设计为非共享享元类.
应用场景:
- 由于共享的特性,可以在任何池中操作:线程池,数据库连接池
- String类
优点:
- 极大的减少内存中对象的数量
- 相同或相似的对象内存中只存一份,极大的节约资源,提高性能
- 外部状态相对独立,不影响内部状态
缺点:
- 模式较复杂,程序逻辑复杂化
- 为了节约内存,共享了内部状态,分离出外部状态,读取外部状态使运行时间边长,时间换空间